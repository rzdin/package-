
pipeline {
    agent any
    environment {
        bucket = "sam-jenkins-demo-us-west-2-rana-ziauddin"
        region = "us-east-1"
        aws_credential = "AWSReservedSSO_AdministratorAccess_564bcbbbca5e5655/rzdin@enquizit.com"
        application_name = "Nodejs"
       
       
    }
     stages{
          stage ('Copy Build Artifact') {
            steps {
                sh 'rm -rf *.zip'
                echo 'Copying artifact from project my-package-jenkins-job'
                copyArtifacts(projectName: 'my-package-jenkins-job', filter:'*.zip', optional: 'true', fingerprintArtifacts: 'false', selector: specific("${BUILD.NUMBER}"));
                // OR
                // copyArtifacts(projectName: 'projectA', filter:'Debug.7z', selector: specific('5'), optional: true);
                
                
            }   
        }
  
          stage("Upload"){
            steps{
                withAWS(credentials: "${aws_credential}", region: "${region}"){
                s3Upload(file:"myapp_${BUILD_TIMESTAMP}.zip", bucket:"${bucket}")
               
                  }
            }
        }
    }
  }
