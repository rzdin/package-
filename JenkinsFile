
pipeline {
    agent any
    environment {
        bucket = "sam-jenkins-demo-us-west-2-rana-ziauddin"
        bucket1 = "sam-jenkins-demo-us-east-2-ranaziauddin"
        region = "us-east-1"
        region1 = "us-east-2"
        aws_credential = "AWSReservedSSO_AdministratorAccess_564bcbbbca5e5655/rzdin@enquizit.com"
        application_name = "Nodejs"
        STRING= "${env.TAG_NAME_DEV}"
       
       
    }
     stages{
          stage ('Copy Build Artifact') {
            steps {
                    sh 'rm -rf *.zip'
                withAWS (credentials: "${aws_credential}", region:"${region1}" ){
                          sh "aws s3 ls"
                          sh "KEY=`aws s3 ls $BUCKET --recursive | sort | tail -n 1 | awk '{print ${4}}'` $ aws s3 cp s3://$BUCKET/$KEY ./latest-object"
                         }
                         
              }   
        }
  }
 } 
